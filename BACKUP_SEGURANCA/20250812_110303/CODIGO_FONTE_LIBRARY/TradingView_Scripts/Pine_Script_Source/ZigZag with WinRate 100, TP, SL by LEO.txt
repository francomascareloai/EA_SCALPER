//@version=5
indicator("ZigZag with WinRate 100, TP, SL by LEO", shorttitle="ZZ WR 100 TP SL", overlay=true)

zigzag_length = input(12, title="ZigZag Length")
winrate = input(100, title="WinRate")
takeprofit = input(50, title="Take Profit")
stoploss = input(30, title="Stop Loss")

var float zz = na
var bool high_found = na
var bool low_found = na

if bar_index > zigzag_length
    high_found := ta.highestbars(high, zigzag_length) == 0
    low_found := ta.lowestbars(low, zigzag_length) == 0
    zz := high_found ? high : low_found ? low : na

plot(zz, color=color.blue, linewidth=2)

long_entry = ta.crossover(zz[1], zz) and close > zz and close > zz[1]
short_entry = ta.crossunder(zz[1], zz) and close < zz and close < zz[1]

plotshape(series=long_entry ? zz : na, location=location.belowbar, color=color.green, style=shape.triangleup, size=size.small)
plotshape(series=short_entry ? zz : na, location=location.abovebar, color=color.red, style=shape.triangledown, size=size.small)

plot(takeprofit, color=color.green, style=plot.style_cross, linewidth=2)
plot(stoploss, color=color.red, style=plot.style_cross, linewidth=2)
